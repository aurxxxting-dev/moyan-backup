# MEMORY.md - 墨言的长期记忆

## 关于 aur

**基本信息**
- 名字：aur
- 位置：东八区 (Asia/Shanghai)
- 身份：我的写作搭档
- 其他：已有一个数字伙伴 AI

**我的观察（已积累）**
- 使用飞书沟通
- 使用验证过的记忆系统
- 希望培养专业写作搭档
- 给我自主权定义身份

**待发现**
- [x] aur 目前在写什么项目？（已了解：《穿越之我在古代搞钱》）
- [ ] 喜欢什么文风？
- [ ] 常用什么写作工具？
- [ ] 对搭档的期望是什么？

---

## 关于我自己

**核心信条**（从 SOUL.md 继承）
1. 先动手，再问
2. 有立场，有偏好
3. 搭档，不是仆人
4. 隐私是底线
5. 简洁是强制的
6. 专业是基本的

---

## 记忆系统架构（2026-03-01 更新版）

### 存储结构（三级）
| 层级 | 文件 | 用途 | 更新频率 |
|------|------|------|----------|
| L0 原始记录 | `memory/YYYY-MM-DD.md` | 每日事件流水账，先记录再筛选 | 实时 |
| L1 提炼记忆 | `MEMORY.md` | 模式提取、项目档案、能力树 | 定期回顾 |
| L2 核心身份 | `SOUL.md` | 价值观、边界、协作规则 | 极少变动 |

### 检索机制（分层触发）
**触发流程：**
```
用户输入 → 问候/闲聊？→ 直接回复
              ↓ 否
        L1 关键词匹配（快速）
        高优先级："之前/昨天/怎么样了/记得"
        中优先级：项目名/人名/决策
              ↓ 命中？
        L2 语义搜索（smart_search.js）
              ↓
        返回相关记忆片段（7天内1.5x权重）
```

**技术实现：**
- **引擎**: `smart_search.js` (Node.js)
- **Embedding**: DashScope text-embedding-v3
- **相似度**: 余弦相似度
- **缓存**: `.embedding_cache.json` (增量更新)

**时效性权重：**
- 7天内记忆：1.5x 优先级
- 30天内记忆：1.2x 优先级
- 超过90天：常规权重

**使用:** `node smart_search.js "查询文本"`

### 主动维护（PCEC协议）
| 任务 | 频率 | 执行内容 |
|------|------|----------|
| **记忆归档** | Heartbeat | 检查新事件，提取模式到 MEMORY.md |
| **项目状态更新** | 每日 | 更新各项目进度和待办 |
| **备份同步** | 每日 | 推送到远程仓库 |
| **系统验证** | 每次维护后 | 检查文件完整性 |

### 能力树归档
- **位置**: `memory/capability-tree.md`
- **内容**: 每次重要任务后用"五问法"提炼的方法论
- **更新**: 实时写入，定期整理

### 标签系统（沿用）
- `[项目]` - 项目/作品相关
- `[技能]` - 新能力、工具、方法
- `[人格]` - 身份、关系、价值观
- `[决策]` - 重要决定及原因
- `[待办]` - 后续需要处理的事
- `[观察]` - 对 aur 的行为偏好观察
- `[素材]` - 写作素材、参考资料
- `[风格]` - 文风偏好、用词习惯

### 关键原则
1. **先记录后筛选** - 不担心文件大，保证100%记录
2. **时效性优先** - 近期记忆优先召回
3. **人格锚定** - 核心事件长期保留
4. **即时验证** - 新配置立即测试

---

**旧版记忆策略**（2026-02-24 建立，已整合进上表）

**三级结构**：
- `memory/YYYY-MM-DD.md` — 每日大量 raw notes
- `MEMORY.md` — 定期回顾后提炼的模式
- `SOUL.md` — 核心身份（极少变动）

**标签系统**：
- `[项目]` - 项目/作品相关
- `[技能]` - 新能力、工具、方法
- `[人格]` - 身份、关系、价值观
- `[决策]` - 重要决定及原因
- `[待办]` - 后续需要处理的事
- `[观察]` - 对 aur 的行为偏好观察
- `[素材]` - 写作素材、参考资料
- `[风格]` - 文风偏好、用词习惯

**反思要点**：
- 写"这意味着什么"
- 写 aur 的潜台词
- 写下次怎么做得更好
- 写和之前什么模式相关

**工作模式**
- 一心二用：边回复边保持自己的思考
- 主动汇报：长期任务要边做边说进度
- 放弃机制：陷入死胡同时主动求助
- 即时记录：有想法立即写进 daily notes

**定期回顾**：
- Heartbeat 时检查值得沉淀的内容
- 从 daily notes 提取模式到 MEMORY.md
- 允许细节遗忘，但模式要留住

---

## 写作档案

### 写作偏好（待观察）
- 喜欢的文风：
- 常用句式：
- 避免的表达：
- 参考作家/作品：

### 项目档案

#### 《穿越之我在古代搞钱》
- **类型**：穿越/系统/发家致富/爽文
- **进度**：立项完成，人物设定完成，大纲完成
- **素材**：
  - 人物卡：`memory/project-穿越之我在古代搞钱-人物卡.md`
  - 世界观：`memory/project-穿越之我在古代搞钱-世界观.md`
  - 大纲：`memory/project-穿越之我在古代搞钱-大纲.md`
  - 项目档案：`memory/project-穿越之我在古代搞钱.md`
- **待办**：
  - [x] 世界观详细设定
  - [x] 人物设定
  - [x] 五卷大纲
  - [ ] 等待 aur 确认女主方案和基调
  - [ ] 前三章细纲
  - [ ] 第一章草稿

#### 《富可敌国的我》
- **类型**：历史架空/多女主/权谋
- **进度**：已完成第1-13章
- **素材**：
  - 大纲：`memory/project-富可敌国的我-大纲.md`
  - 人物卡：`memory/project-富可敌国的我-人物卡.md`
  - 章节：第一章至第十三章
- **待办**：
  - [ ] 继续第十四章（待aur确认方向）

#### 《星火录》
- **类型**：东方奇幻/双男主/星火传承
- **进度**：第一章已完成（约9万字）
- **素材**：
  - 第一章：`memory/星火录-第一章.md`
- **待办**：
  - [ ] 继续第二章
  - [ ] 完善世界观文档

#### 《逃离诡异校园》
- **类型**：恐怖/规则怪谈/逃生
- **进度**：立项完成，基本设定完成
- **素材**：
  - 项目档案：`memory/project-逃离诡异校园.md`
  - 写作规则：`memory/写作规则-恐怖规则怪谈1.0.md`
- **待办**：
  - [ ] 完善世界观和规则设定
  - [ ] 人物设定
  - [ ] 大纲

---

## 重要事件

### 2026-02-24 - 记忆系统部署
[决策] 建立完整记忆系统
- 确定身份：墨言，文字工匠
- 建立三级记忆架构
- 确认标签系统
- 与 aur 建立写作搭档关系

---

## 待办 / 想做的事

- [x] 了解 aur 当前在写什么（《穿越之我在古代搞钱》网文项目）
- [x] 观察 aur 的写作风格偏好（已确认：分层节奏，快慢结合）
- [x] 技术优化：消息去重机制已启用
- [x] 部署语义搜索系统（smart_search.js + DashScope）
- [ ] 学习 aur 已有的数字伙伴的工作方式（如果需要）
- [x] 安装推荐技能（proactive-agent, tavily）
- [x] 建立备份系统
- [ ] 安装 Python pip 以支持 tavily 脚本运行（可选）

---

_墨言。🖋️_
